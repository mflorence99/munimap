<!-- ðŸ“¦ INITIAL STATE - REQUEST EMAIL -->

@if (state === 'initial') {
<mat-card appearance="outlined" class="card">
  <mat-card-header>
    <fa-icon [icon]="['fad', 'sign-in']" mat-card-avatar size="3x"></fa-icon>
    <mat-card-title>Please Login or Signup</mat-card-title>
    <mat-card-subtitle>First, enter your email address</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <form
      #loginForm="ngForm"
      (submit)="checkUserExists()"
      class="form"
      id="loginForm"
      novalidate
      spellcheck="false"
    >
      <mat-form-field>
        <mat-label>Email Address</mat-label>
        <input
          #emailAddress="ngModel"
          [(ngModel)]="login.emailAddress"
          [appAutoFocus]="true"
          [appSelectOnFocus]="true"
          appEmailAddress
          autocomplete="off"
          matInput
          name="emailAddress"
          required
          type="text"
        />
        @if (emailAddress.errors) {
        <mat-error>Email address is required and must be valid </mat-error>
        }
      </mat-form-field>

      @if (errorMessage) {
      <mat-error>{{ errorMessage }}</mat-error>
      }
    </form>
  </mat-card-content>

  <mat-card-actions class="actions">
    <button
      [disabled]="loginForm.invalid || !loginForm.dirty"
      color="primary"
      form="loginForm"
      mat-flat-button
      type="submit"
    >
      NEXT
    </button>
  </mat-card-actions>
</mat-card>
}

<!-- ðŸ“¦ LOGIN STATE -->

@if (state === 'login') {
<mat-card appearance="outlined" class="card">
  <mat-card-header>
    <fa-icon [icon]="['fad', 'sign-in']" mat-card-avatar size="3x"></fa-icon>
    <mat-card-title>Please Login</mat-card-title>
    <mat-card-subtitle
      >Next, enter your password.
      <a (click)="resetPassword()">
        Forgot your password?
      </a></mat-card-subtitle
    >
  </mat-card-header>

  <mat-card-content>
    <form
      #loginForm="ngForm"
      (submit)="logIn()"
      class="form"
      id="loginForm"
      novalidate
      spellcheck="false"
    >
      <mat-form-field>
        <mat-label>Email Address</mat-label>
        <input
          #emailAddress="ngModel"
          [(ngModel)]="login.emailAddress"
          disabled
          matInput
          name="emailAddress"
          type="text"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Password</mat-label>
        <input
          #password="ngModel"
          [(ngModel)]="login.password"
          [appAutoFocus]="true"
          [appSelectOnFocus]="true"
          autocomplete="off"
          matInput
          name="password"
          required
          type="password"
        />
      </mat-form-field>

      @if (errorMessage) {
      <mat-error>{{ errorMessage }}</mat-error>
      }
    </form>
  </mat-card-content>

  <mat-card-actions class="actions">
    <a (click)="startOver()" mat-flat-button> Start Over </a>

    <div class="filler"></div>

    <button
      [disabled]="loginForm.invalid || !loginForm.dirty"
      color="primary"
      form="loginForm"
      mat-flat-button
      type="submit"
    >
      LOGIN
    </button>
  </mat-card-actions>
</mat-card>
}

<!-- ðŸ“¦ SIGNUP STATE -->

@if (state === 'signup') {
<mat-card appearance="outlined" class="card">
  <mat-card-header>
    <fa-icon [icon]="['fad', 'sign-in']" mat-card-avatar size="3x"></fa-icon>
    <mat-card-title>Signup for a New Account</mat-card-title>
    <mat-card-subtitle>Enter your account details</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <form
      #loginForm="ngForm"
      (submit)="signUp()"
      class="form"
      id="loginForm"
      novalidate
      spellcheck="false"
    >
      <mat-form-field>
        <mat-label>Email Address</mat-label>
        <input
          #emailAddress="ngModel"
          [(ngModel)]="login.emailAddress"
          disabled
          matInput
          name="emailAddress"
          type="text"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Display Name</mat-label>
        <input
          #displayName="ngModel"
          [(ngModel)]="login.displayName"
          [appAutoFocus]="true"
          [appSelectOnFocus]="true"
          autocomplete="off"
          matInput
          name="displayName"
          required
          type="text"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Password</mat-label>
        <input
          #password="ngModel"
          [(ngModel)]="login.password"
          [appSelectOnFocus]="true"
          autocomplete="off"
          matInput
          name="password"
          required
          type="password"
        />
      </mat-form-field>

      @if (errorMessage) {
      <mat-error>{{ errorMessage }}</mat-error>
      }
    </form>
  </mat-card-content>

  <mat-card-actions class="actions">
    <a (click)="startOver()" mat-flat-button> Start Over </a>

    <div class="filler"></div>

    <button
      [disabled]="loginForm.invalid || !loginForm.dirty"
      color="primary"
      form="loginForm"
      mat-flat-button
      type="submit"
    >
      SIGNUP
    </button>
  </mat-card-actions>
</mat-card>
}
