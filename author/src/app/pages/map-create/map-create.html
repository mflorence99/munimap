<app-ol-map #olMap [fitToBounds]="true" [path]="path">
  <app-map-filter
    (pathChanged)="onPathChanged($event)"
    (pathSelected)="onPathSelected($event)"
    [path]="path"
    mapControlPanel1
  >
  </app-map-filter>

  <!-- ðŸ“¦ CUSTOM CONTROLS -->

  <app-ol-control-zoom2extent
    mapControlZoomToExtent
  ></app-ol-control-zoom2extent>

  <app-ol-control-attribution
    mapControlAttribution
  ></app-ol-control-attribution>

  <ng-container *ngIf="olMap.initialized">
    <!-- ðŸ“¦ OL CONTROLS -->

    <app-ol-control-graticule
      ><app-ol-style-graticule></app-ol-style-graticule
    ></app-ol-control-graticule>

    <app-ol-control-scaleline></app-ol-control-scaleline>

    <!-- ðŸ“¦ OUTSIDE TOWN -->

    <app-ol-layer-tile>
      <app-ol-source-xyz
        [maxZoom]="19"
        [url]="'https://tile.openstreetmap.org/{z}/{x}/{y}.png'"
        ><app-ol-attribution
          >Â©
          <a href="https://www.openstreetmap.org/copyright" target="_blank"
            >OpenStreetMap</a
          >
          contributors</app-ol-attribution
        ></app-ol-source-xyz
      >
      <app-ol-filter-pencil></app-ol-filter-pencil>
    </app-ol-layer-tile>

    <!-- ðŸ“¦ OUTSIDE TOWN -->

    <app-ol-layer-tile>
      <app-ol-source-xyz
        [maxZoom]="19"
        [url]="'https://tile.openstreetmap.org/{z}/{x}/{y}.png'"
        ><app-ol-attribution
          >Â©
          <a href="https://www.openstreetmap.org/copyright" target="_blank"
            >OpenStreetMap</a
          >
          contributors</app-ol-attribution
        ></app-ol-source-xyz
      >
      <app-ol-filter-crop2boundary></app-ol-filter-crop2boundary>
    </app-ol-layer-tile>

    <!-- ðŸ“¦ SELECTABLES LAYER -->

    <app-ol-layer-vector *ngIf="!atTownLevel(path)">
      <app-ol-style-polygons [filter]="filter()"></app-ol-style-polygons>
      <app-ol-source-geojson [layerKey]="'selectables'">
      </app-ol-source-geojson>

      <app-ol-interaction-select [eventType]="'pointermove'">
      </app-ol-interaction-select>

      <app-ol-interaction-select
        (featuresSelected)="onFeaturesSelected($event)"
        [eventType]="'click'"
        [filter]="filter()"
        [multi]="false"
      >
      </app-ol-interaction-select>
    </app-ol-layer-vector>

    <!-- ðŸ“¦ BOUNDARY LAYER -->

    <app-ol-layer-vector *ngIf="atTownLevel(path)">
      <app-ol-style-polygons></app-ol-style-polygons>
      <app-ol-source-boundary></app-ol-source-boundary>
    </app-ol-layer-vector>
  </ng-container>
</app-ol-map>
