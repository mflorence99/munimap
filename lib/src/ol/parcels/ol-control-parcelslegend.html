<article
  #legend
  [ngClass]="{ 'ol-legend-print': printing, 'ol-legend-screen': !printing }"
  class="legend ol-legend ol-unselectable ol-control"
>
  <header class="header">
    <h1 class="title">{{ title }}</h1>
    <h2 class="subtitle">{{ county }} Co</h2>
    <h2 class="subtitle">{{ state }}</h2>
    <h3 class="link">{{ id }}.munimap.online</h3>
  </header>

  <table class="areaByUsage">
    <thead>
      <tr>
        <th></th>
        <th></th>
        <th class="numeric">Acres</th>
      </tr>
    </thead>

    <tbody>
      <ng-container
        *ngFor="let usage of registry.list('parcel', 'usage'); trackBy: trackByUsage"
      >
        <tr *ngIf="areaByUsage[usage[0]]">
          <td class="usage">
            <figure
              [style.backgroundColor]="'rgba(var(--map-parcel-fill-u' + usage[0] + '), 0.25)'"
              class="key"
            ></figure>
          </td>
          <td class="desc">{{ usage[1].decoding }}</td>
          <td class="numeric">{{ areaByUsage[usage[0]] | number: '1.0-0' }}</td>
        </tr>

        <tr *ngIf="usage[0] === '190'">
          <td></td>
          <td class="use">
            <article class="keys">
              <ng-container
                *ngFor="let use of registry.list('parcel', 'use'); trackBy: trackByUsage"
              >
                <!-- ðŸ”¥ TEMPORARY -- WASHINGTON ONLY -->
                <figure
                  *ngIf="['CUFL', 'CUMH', 'CUMW', 'CUUH', 'CUUW', 'CUWL'].includes(use[0])"
                  class="key"
                >
                  <img [src]="'assets/legend/' + use[0] +'.png'" class="icon" />
                  <figcaption>{{ use[1].decoding }}</figcaption>
                </figure>
              </ng-container>
            </article>
          </td>
          <td></td>
        </tr>
      </ng-container>

      <tr>
        <td></td>
        <td class="desc">Lakes, ponds, rights of way</td>
        <td class="numeric">
          {{ areaOfTown - areaOfParcels | number: '1.0-0' }}
        </td>
      </tr>

      <tr>
        <td></td>
        <td class="des">
          <article class="keys">
            <figure class="key">
              <div
                [style.backgroundImage]="'url(\'' + iconFloodplain.getImage().toDataURL() +  '\')'"
                class="icon"
              ></div>
              <figcaption>FEMA Floodplain</figcaption>
            </figure>

            <figure class="key">
              <div
                [style.backgroundImage]="'url(\'' + iconPeatland.getImage().toDataURL() +  '\')'"
                class="icon"
              ></div>
              <figcaption>Peatland</figcaption>
            </figure>

            <figure class="key">
              <div
                [style.backgroundImage]="'url(\'' + iconWetland.getImage().toDataURL() +  '\')'"
                class="icon"
              ></div>
              <figcaption>Wetland</figcaption>
            </figure>
          </article>
        </td>
        <td></td>
      </tr>

      <tr class="total">
        <td></td>
        <td class="desc">Total</td>
        <td class="numeric">{{ areaOfTown | number: '1.0-0' }}</td>
      </tr>
    </tbody>
  </table>
</article>
