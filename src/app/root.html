<main class="page">
  <mat-toolbar class="toolbar">
    <button
      (click)="drawer.toggle()"
      [disabled]="!(user$ | async)"
      mat-icon-button
    >
      <mat-icon>menu</mat-icon>
    </button>
    <h1>MuniMap</h1>
    <div class="filler"></div>
    <ng-container *ngIf="user$ | async as user">
      <ngx-avatar
        #trigger="cdkOverlayOrigin"
        (clickOnAvatar)="openUserProfile = !openUserProfile"
        [gravatarId]="user.photoURL ? null : user.email"
        [initialsSize]="2"
        [name]="user.displayName"
        [round]="true"
        [size]="48"
        [src]="user.photoURL"
        cdkOverlayOrigin
        class="avatar"
      ></ngx-avatar>

      <ng-template
        cdkConnectedOverlay
        (backdropClick)="openUserProfile = false"
        [cdkConnectedOverlayHasBackdrop]="true"
        [cdkConnectedOverlayOrigin]="trigger"
        [cdkConnectedOverlayOpen]="openUserProfile"
      >
        <app-user-profile (done)="openUserProfile = false"></app-user-profile>
      </ng-template>
    </ng-container>
  </mat-toolbar>

  <mat-drawer-container class="container">
    <mat-drawer #drawer class="sidebar" mode="over">
      <a (click)="drawer.close()" routerLink="/dummy">link to dummy</a>
      <br />
      <a (click)="drawer.close()" routerLink="/maps">link to maps</a>
      <br />
      <a (click)="drawer.close()" routerLink="/map">link to map</a>
    </mat-drawer>

    <mat-drawer-content [@moveFromLeftFade]="getState()" class="content">
      <router-outlet></router-outlet>
    </mat-drawer-content>
  </mat-drawer-container>
</main>
